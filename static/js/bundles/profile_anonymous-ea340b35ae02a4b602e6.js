!function(e){function t(t){for(var n,o,s=t[0],i=t[1],u=t[2],p=0,h=[];p<s.length;p++)o=s[p],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&h.push(r[o][0]),r[o]=0;for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n]);for(c&&c(t);h.length;)h.shift()();return l.push.apply(l,u||[]),a()}function a(){for(var e,t=0;t<l.length;t++){for(var a=l[t],n=!0,s=1;s<a.length;s++){var i=a[s];0!==r[i]&&(n=!1)}n&&(l.splice(t--,1),e=o(o.s=a[0]))}return e}var n={},r={7:0},l=[];function o(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=n,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(a,n,function(t){return e[t]}.bind(null,n));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var s=window.webpackJsonp=window.webpackJsonp||[],i=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var c=i;l.push([1958,0]),a()}({1958:function(e,t,a){"use strict";a.r(t);var n=a(16),r=a.n(n),l=a(0),o=a.n(l),s=a(771),i=a(793),u=a(1971),c=a(773),p=a(1967),h=a(1968),m=a(764),d=a(1969),f=a(768),v=a(1972),g=a(36),y=a.n(g);y.a.defaults.xsrfHeaderName="X-CSRFToken",y.a.defaults.xsrfCookieName="csrftoken";function E(){return(E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function b(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function N(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function k(e){return o.a.createElement("div",{style:{width:"30rem",textAlign:"left",border:"solid 1px #c8ccd0",boxShadow:"0 1px 5px rgba(12,13,14,0.3)",zIndex:"3000",position:"relative",padding:"1.5rem",backgroundColor:"#FFF",top:"0"}},o.a.createElement("h4",null,"Change your picture"),o.a.createElement(p.a,{fluid:!0,style:{padding:0}},e.userAvatar?o.a.createElement("div",null,o.a.createElement(h.a,{className:"pointer",onClick:function(){e.selectAvatar("u")}},o.a.createElement(m.a,{sm:3,md:3},o.a.createElement(d.a,{responsive:!0,rounded:!0,src:e.userAvatar})),o.a.createElement(m.a,{sm:7,md:7,className:"vcenter"},o.a.createElement("h4",null,"Uploaded picture")),o.a.createElement(m.a,{sm:1,md:1},"u"===e.selectedAvatar?o.a.createElement("span",{className:"glyphicon glyphicon-ok"}):null)),o.a.createElement("hr",null)):null,e.googleAvatarUrl?o.a.createElement("div",null,o.a.createElement(h.a,{className:"pointer",onClick:function(){e.selectAvatar("g")}},o.a.createElement(m.a,{sm:3,md:3},o.a.createElement(d.a,{responsive:!0,rounded:!0,src:e.googleAvatarUrl})),o.a.createElement(m.a,{sm:7,md:7,className:"vcenter"},o.a.createElement("h4",null,"Google")),o.a.createElement(m.a,{sm:1,md:1},"g"===e.selectedAvatar?o.a.createElement("span",{className:"glyphicon glyphicon-ok"}):null)),o.a.createElement("hr",null)):null,e.gravatarUrl?o.a.createElement("div",null,o.a.createElement(h.a,{className:"pointer",onClick:function(){return e.selectAvatar("a")}},o.a.createElement(m.a,{sm:3,md:3},o.a.createElement(d.a,{responsive:!0,rounded:!0,src:e.gravatarUrl})),o.a.createElement(m.a,{sm:7,md:7,className:"vcenter"},o.a.createElement("h4",null,"Gravatar")),o.a.createElement(m.a,{sm:1,md:1},"a"===e.selectedAvatar?o.a.createElement("span",{className:"glyphicon glyphicon-ok"}):null)),o.a.createElement("hr",null)):null))}var _=function(e){function t(e,a){var n,r,l;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(l=C(t).call(this,e,a))||"object"!=typeof l&&"function"!=typeof l?N(r):l).onChangeAvatarClick=n.onChangeAvatarClick.bind(N(n)),n.selectAvatar=n.selectAvatar.bind(N(n)),n.state={showChangeImagePanel:!1},n}var a,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(t,o.a.Component),a=t,(n=[{key:"selectAvatar",value:function(e){var t=this;y.a.patch("/api/v1/profiles/me",{selected_avatar:e}).then(function(e){t.props.profileToState(e.data)})}},{key:"onChangeAvatarClick",value:function(){this.setState({showChangeImagePanel:!0})}},{key:"render",value:function(){var e=this;return o.a.createElement("form",null,o.a.createElement(p.a,{fluid:!0},o.a.createElement(h.a,null,o.a.createElement(m.a,{sm:3,md:3},this.props.avatarUrl?o.a.createElement(FormGroup,null,o.a.createElement(d.a,{responsive:!0,src:this.props.avatarUrl,rounded:!0})):null,o.a.createElement("div",{ref:function(t){e._changeImageButton=t},style:{fontSize:"1.3rem",textAlign:"center",cursor:"pointer"},onClick:this.onChangeAvatarClick},"Change picture"),o.a.createElement(f.a,{rootClose:Boolean(!0),show:this.state.showChangeImagePanel,onHide:function(){return e.setState({showChangeImagePanel:!1})},placement:"bottom",container:this._changeImageButton},o.a.createElement(k,E({},this.props,{selectAvatar:this.selectAvatar})))),o.a.createElement(m.a,{sm:9,md:9},o.a.createElement(v.a,null,o.a.createElement(v.a.Group,null,o.a.createElement(v.a.Label,null,"First Name"),o.a.createElement(v.a.Control,{type:"text",value:this.props.firstName,placeholder:"First",onChange:this.props.firstNameChange})),o.a.createElement(v.a.Group,null,o.a.createElement(v.a.Label,null,"Last Name"),o.a.createElement(v.a.Control,{type:"text",value:this.props.lastName,placeholder:"Last",onChange:this.props.lastNameChange})),o.a.createElement(v.a.Group,null,o.a.createElement(v.a.Label,null,"Display Name"),o.a.createElement(v.a.Control,{type:"text",value:this.props.displayName,placeholder:"Display",onChange:this.props.displayNameChange})),o.a.createElement(v.a.Group,null,o.a.createElement(v.a.Label,null,"Sound Enabled"),o.a.createElement(v.a.Check,{checked:this.props.soundEnabled,onChange:this.props.toggleSound})))))))}}])&&b(a.prototype,n),r&&b(a,r),t}();function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function O(e,t,a){return t&&A(e.prototype,t),a&&A(e,a),e}function P(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function x(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var U=function(e){function t(){return w(this,t),P(this,j(t).apply(this,arguments))}return x(t,o.a.Component),O(t,[{key:"render",value:function(){return o.a.createElement("form",null,o.a.createElement(s.a,null,o.a.createElement(i.a,null,o.a.createElement("h4",null,"Sound settings"),o.a.createElement(i.a.Input,{checked:this.props.soundEnabled,onChange:this.props.toggleSound,type:"checkbox"}),o.a.createElement(i.a.Label,null,"Sound enabled"))))}}]),t}(),I=function(e){function t(){return w(this,t),P(this,j(t).apply(this,arguments))}return x(t,o.a.Component),O(t,[{key:"render",value:function(){var e,t;return this.props.isAnonymous?(e="Settings",t=o.a.createElement(U,this.props)):(e=this.props.firstName||this.props.lastName?this.props.firstName+" "+this.props.lastName:"Profile",t=o.a.createElement(_,this.props)),o.a.createElement("span",null,o.a.createElement("span",{className:"settings",onClick:this.props.open},e),o.a.createElement(u.a,{className:"settings-modal",show:this.props.show,onHide:this.props.close,"aria-labelledby":"ModalHeader"},o.a.createElement(u.a.Header,{closeButton:!0},o.a.createElement(u.a.Title,null,"Profile")),o.a.createElement(u.a.Body,null,t),o.a.createElement(u.a.Footer,null,o.a.createElement(c.a,{onClick:this.props.save,disabled:this.props.hasErrors},"Save changes"))))}}]),t}(),B=function(e){function t(){var e;return w(this,t),(e=P(this,j(t).call(this))).state={soundEnabled:!0,firstName:"",lastName:"",displayName:"",show:!1,hasErrors:!0},e.fetchProfile(),e}return x(t,o.a.Component),O(t,[{key:"toggleSound",value:function(e){var t=!this.state.soundEnabled;this.setState({soundEnabled:t,hasErrors:!1}),SoundSingleton.soundEnabled=t,SoundSingleton.soundEnabled?unpauseBackgroundAudio():pauseBackgroundAudio()}},{key:"modalOpen",value:function(e){this.preSaveSoundEnabled=this.state.soundEnabled,this.setState({show:!0})}},{key:"modalClose",value:function(e,t){var a={show:!1};!0!==t&&(a.soundEnabled=this.preSaveSoundEnabled),this.setState(a),SoundSingleton.soundEnabled=this.preSaveSoundEnabled,this.fetchProfile()}},{key:"modalSave",value:function(e){this.updateProfile(e),this.modalClose(e,!0)}},{key:"firstNameChange",value:function(e){var t=!0;e.target.value&&(t=!1),this.setState({firstName:e.target.value,hasErrors:t})}},{key:"lastNameChange",value:function(e){var t=!0;e.target.value&&(t=!1),this.setState({lastName:e.target.value,hasErrors:t})}},{key:"displayNameChange",value:function(e){var t=!0;e.target.value&&(t=!1),this.setState({displayName:e.target.value,hasErrors:t})}},{key:"profileToState",value:function(e){this.setState({firstName:e.first_name,lastName:e.last_name,displayName:e.display_name,soundEnabled:e.sound_enabled,isAnonymous:e.is_anonymous,selectedAvatar:e.selected_avatar,googleAvatarUrl:e.google_avatar_url,gravatarUrl:e.gravatar_url,userAvatar:e.user_avatar,avatarUrl:e.avatar_url}),SoundSingleton.soundEnabled=e.sound_enabled}},{key:"fetchProfile",value:function(e){$.ajax({async:!0,url:"/api/v1/profiles/me",context:this,success:function(e,t,a){this.profileToState(e)}})}},{key:"updateProfile",value:function(e){var t={first_name:this.state.firstName,last_name:this.state.lastName,display_name:this.state.displayName,sound_enabled:this.state.soundEnabled};$.ajax({type:"PATCH",url:"/api/v1/profiles/me/",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify(t),context:this,success:function(e,t,a){this.profileToState(e)}})}},{key:"render",value:function(){return o.a.createElement(I,{firstName:this.state.firstName,lastName:this.state.lastName,displayName:this.state.displayName,soundEnabled:this.state.soundEnabled,hasErrors:this.state.hasErrors,isAnonymous:this.state.isAnonymous,avatar_url:this.state.avatar_url,googleAvatarUrl:this.state.googleAvatarUrl,gravatarUrl:this.state.gravatarUrl,userAvatar:this.state.userAvatar,avatarUrl:this.state.avatarUrl,selectedAvatar:this.state.selectedAvatar,show:this.state.show,toggleSound:this.toggleSound.bind(this),open:this.modalOpen.bind(this),close:this.modalClose.bind(this),save:this.modalSave.bind(this),firstNameChange:this.firstNameChange.bind(this),lastNameChange:this.lastNameChange.bind(this),displayNameChange:this.displayNameChange.bind(this),updateProfile:this.updateProfile.bind(this),profileToState:this.profileToState.bind(this)})}}]),t}();r.a.render(o.a.createElement(B,null),document.getElementById("react-profile-modal"))}});